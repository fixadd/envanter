{% extends "base.html" %} {% block title %}Lisans {{ 'Düzenle' if license else
'Ekle' }}{% endblock %} {% block content %}
<div class="container-fluid p-3">
  <div class="form-shell">
    <div class="form-shell__header">
      <div>
        <h2 class="form-shell__title">
          Lisans {{ 'Düzenle' if license else 'Ekle' }}
        </h2>
        <p class="form-shell__subtitle">
          Lisans kayıtlarınızdaki bilgileri kolayca yönetin.
        </p>
      </div>
      {% if not modal %}
      <div class="form-shell__header-actions">
        <a class="btn btn-light" href="{{ url_for('license_list') }}">
          ← Listeye Dön
        </a>
      </div>
      {% endif %}
    </div>

    <form
      method="post"
      action="{{ form_action }}{{ '?modal=1' if modal else '' }}"
      class="form-shell__form"
    >
      <div class="form-shell__body">
        <div class="form-grid">
          <div>
            <label class="form-label">Lisans Adı</label>
            <select name="adi" class="form-select" required>
              <option value="">Seçiniz...</option>
              {% for ln in license_names %}
              <option
                value="{{ ln.name }}"
                {%
                if
                license
                and
                license.lisans_adi=""
                ="ln.name"
                %}selected{%
                endif
                %}
              >
                {{ ln.name }}
              </option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label class="form-label">Lisans Anahtarı</label>
            <input
              name="anahtar"
              class="form-control"
              value="{{ license.anahtar if license else '' }}"
            />
          </div>

          <div>
            <label class="form-label">Sorumlu Personel</label>
            <select name="sorumlu_personel" class="form-select">
              <option value="">(Seçiniz)</option>
              {% for u in users %}
              <option
                value="{{ u }}"
                {%
                if
                license
                and
                license.sorumlu_personel=""
                ="u"
                %}selected{%
                endif
                %}
              >
                {{ u }}
              </option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label class="form-label">Bağlı Olduğu Envanter No</label>
            <select
              id="selBagliEnvanter"
              name="inventory_id"
              class="form-select"
            >
              <option value="">(Seçimsiz)</option>
              {% for inv in envanterler %}
              <option
                value="{{ inv.id }}"
                {%
                if
                license
                and
                license.inventory_id=""
                ="inv.id"
                %}selected{%
                endif
                %}
              >
                {{ inv.no }} — {{ inv.marka }} {{ inv.model }}
              </option>
              {% endfor %}
            </select>
          </div>

          <div>
            <label class="form-label">IFS No</label>
            <input
              name="ifs_no"
              class="form-control"
              value="{{ license.ifs_no if license else '' }}"
            />
          </div>

          <div>
            <label class="form-label">Mail Adresi</label>
            <input
              type="email"
              name="mail_adresi"
              class="form-control"
              value="{{ license.mail_adresi if license else '' }}"
            />
          </div>
        </div>
      </div>

      <div class="form-shell__actions">
        <button class="btn btn-primary" type="submit">Kaydet</button>
        {% if not modal %}
        <a
          class="btn btn-outline-secondary"
          href="{{ url_for('license_list') }}"
          >İptal</a
        >
        {% endif %}
      </div>
    </form>
  </div>
</div>
{% endblock %} {% block scripts %} {{ super() }}
<script>
  // Aramalı select (Choices varsa)
  document.addEventListener("DOMContentLoaded", () => {
    if (window.Choices) {
      new Choices("#selBagliEnvanter", {
        searchEnabled: true,
        itemSelectText: "",
      });
    }
  });
</script>
{% endblock %}
